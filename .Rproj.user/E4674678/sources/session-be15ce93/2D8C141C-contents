---
title: "Final project"
author: "Adriana Gutierrez Yllu"
date: "2025-10-01"
output: html_document
---

```{r, set-chunk-opts, echo = FALSE, include=FALSE}
library(knitr)
library(labelled)
library(gtsummary)
library(readxl)
library(here)
library(dplyr)
library(ggplot2)


opts_chunk$set(
  echo = FALSE, warning = FALSE, message = FALSE
)
```

# Introduction
This dataset captures participants' initial visit to a pilot program designed to enhance awareness and facilitate early detection of hypertension through free blood pressure screenings and a brief educational session on lifestyle modification. Despite these efforts the program has not achieved the intended level of reach. 

The first objective of this process evaluation report is to identify key barriers and facilitators influencing participation in the pilot hypertension screening program. 

The second objective is to assess participants' preferences from the pilot program to inform the implementation of the full- scale program. 


```{r, load-data, echo=FALSE, include=FALSE}
here::i_am("Final project.Rmd")
absolute_path_to_data <- here::here("data", "raw_data.xlsx")
data <- readxl::read_excel(absolute_path_to_data)

head(data)
```

### Table 1. Baseline characteristics of participants

```{r, table-1}
var_label(data) <- list(
  participant_ID = "ID",
  age = "Age",
  gender = "Gender",
  ethnicity = "Ethnicity",
  race = "Race",
  job_currently = "Actively working",
  insurance = "Insurance",
  fast_food_daily = "Daily consumption of fast food",
  veggies_daily = "Daily consusmtion of vaggies",
  sweet_beverages_frequency = "Sweetened beverages",
  nutrition_talk_ever = "Nutrition talk ever",
  challenges_healthy_food = "Challenges to consume healthy food",
  hear_about_program = "How did you hear about this program?",
  reason_attendance_today = "Reason to attend today",
  first_hypertension_screening_ever = "First time in a HTN screening",
  location_convenient = "Was the location convenient to you?",
  needed_healthcare_couldnt_access = "Have you ever needed medical care and been unable to get it?",
  personal_history_hypertension = "Previous diagnosis of Hypertension",
  family_history_hypertension = "Family member with hypertension",
  systolic_bp = "Systolic BP",
  dyastolic_bp = "Dyastolic BP",
  bp_normal = "BP normal?",
  high_bp_informed = "Were you informed about your BP after the measurement?",
  followup_with_provider = "Were you adviced to FU with a healthcare provider?",
  access_provider_perception = "Will you be able to FU with a provider?",
  access_treatment_perception = "Will you be able to get treatment?",
  lify_Style_change_dic = "",
  salt_reduction = "Reduced salt consumption",
  exercise = "Excercise",
  started_treatment = "Treatment initiated",
  life_style_changes_all = "All lifestyle changes",
  want_follow_up = "Desire to join the program",
  best_contact = "Contact method preference",
  day_preference = "Preferred day for contact",
  day_time = "Preferred time for contact",
  gave_phone_number = "Phone number provideed",
  reach_more_ppl = "How can we reach more people?",
  other_comments_improve = "Extra comments on how to improve the program"
)

data$age_cat <- ifelse(data$age <= 50, "50 years or younger", "Over 50 years")

data |>
  select("gender", "race", "ethnicity", "age_cat", "insurance",  "job_currently", "nutrition_talk_ever", "fast_food_daily", "sweet_beverages_frequency", "veggies_daily", "challenges_healthy_food", "personal_history_hypertension", "family_history_hypertension") |>
  tbl_summary(by = "age_cat") |>
  modify_spanning_header(c("stat_1", "stat_2") ~ "**Participants stratified by age**") |>
  add_overall() |>
  add_p()
```
#### Table 1 - Description.
Table 1 summarizes the baseline characteristics of participants in the pilot hypertension screening program, stratified by age group (≤50 years and >50 years). All the participants were Hispanic. 

```{r, in-text-percentages, include=FALSE}
# Totals by age group
n_total_under50 <- sum(data$age_cat == "50 years or younger")
n_total_over50  <- sum(data$age_cat == "Over 50 years")

# Insurance
n_ins_under50 <- sum(data$insurance[data$age_cat=="50 years or younger"]=="Yes")
perc_ins_under50 <- round(n_ins_under50 / n_total_under50 * 100, 0)

n_ins_over50 <- sum(data$insurance[data$age_cat=="Over 50 years"]=="Yes")
perc_ins_over50 <- round(n_ins_over50 / n_total_over50 * 100, 0)

# Actively working
n_work_under50 <- sum(data$job_currently[data$age_cat=="50 years or younger"]=="Yes")
perc_work_under50 <- round(n_work_under50 / n_total_under50 * 100, 0)

n_work_over50 <- sum(data$job_currently[data$age_cat=="Over 50 years"]=="Yes")
perc_work_over50 <- round(n_work_over50 / n_total_over50 * 100, 0)

# Nutrition talks
n_talk_under50 <- sum(data$nutrition_talk_ever[data$age_cat=="50 years or younger"]=="Yes")
perc_talk_under50 <- round(n_talk_under50 / n_total_under50 * 100, 0)

n_talk_over50 <- sum(data$nutrition_talk_ever[data$age_cat=="Over 50 years"]=="Yes")
perc_talk_over50 <- round(n_talk_over50 / n_total_over50 * 100, 0)

# Fast food daily
n_fast_under50 <- sum(data$fast_food_daily[data$age_cat=="50 years or younger"]=="Yes")
perc_fast_under50 <- round(n_fast_under50 / n_total_under50 * 100, 0)

n_fast_over50 <- sum(data$fast_food_daily[data$age_cat=="Over 50 years"]=="Yes")
perc_fast_over50 <- round(n_fast_over50 / n_total_over50 * 100, 0)

# Personal history of hypertension
n_personal <- sum(data$personal_history_hypertension=="Yes")
perc_personal <- round(n_personal / nrow(data) * 100, 0)

# Family history of hypertension
n_fam_under50 <- sum(data$family_history_hypertension[data$age_cat=="50 years or younger"]=="Yes")
perc_fam_under50 <- round(n_fam_under50 / n_total_under50 * 100, 0)

n_fam_over50 <- sum(data$family_history_hypertension[data$age_cat=="Over 50 years"]=="Yes")
perc_fam_over50 <- round(n_fam_over50 / n_total_over50 * 100, 0)
```


Most participants reported having health insurance, though coverage was more consistent among those over 50 years (`r perc_ins_over50`% (`r n_ins_over50`/`r n_total_over50`)) compared to younger participants (`r perc_ins_under50`% (`r n_ins_under50`/`r n_total_under50`)). A greater proportion of younger participants were actively working (`r perc_work_under50`% (`r n_work_under50`/`r n_total_under50`)) vs. older participants (`r perc_work_over50`% (`r n_work_over50`/`r n_total_over50`)). Nutrition talks were reported more often by older participants (`r perc_talk_over50`% (`r n_talk_over50`/`r n_total_over50`)) compared with younger participants (`r perc_talk_under50`% (`r n_talk_under50`/`r n_total_under50`)).

Regarding health history, a personal history of hypertension was reported by both age groups (`r perc_personal`% (`r n_personal`/`r nrow(data)`)), and family history of hypertension was more common among younger participants (`r perc_fam_under50`% (`r n_fam_under50`/`r n_total_under50`)) than older participants (`r perc_fam_over50`% (`r n_fam_over50`/`r n_total_over50`)).



### Figure 1. Suggestions to Reach More People by Age Group 

```{r plot-data, fig.align="center", message=FALSE, out.width="600px"}
data$median_bp <- data$dyastolic_bp + (data$systolic_bp - data$dyastolic_bp)/3


percent_data <- data %>%
  group_by(age_cat, reach_more_ppl) %>%
  summarise(count = n(), .groups = "drop") %>%
  group_by(age_cat) %>%
  mutate(percent = count / sum(count) * 100)

# Plot: grouped bar chart with percentages
ggplot(percent_data, aes(x = reach_more_ppl, y = percent, fill = age_cat)) +
  geom_col(position = "dodge") +  # side-by-side bars
  labs(
    title = "Suggestions to Reach More People by Age Group",
    x = "Suggestion",
    y = "Percentage (%)",
    fill = "Age Group"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Figure 1 - Description.
This figure presents participants’ suggestions on how to reach more people with the hypertension screening program, stratified by age group.  

Among younger participants, the most common suggestions were increasing advertising (`r round(100 * sum(data$reach_more_ppl == "Increase advertising" & data$age_cat == "50 years or younger") / sum(data$age_cat == "50 years or younger"), 1)`%) and “don’t know” (`r round(100 * sum(data$reach_more_ppl == "Don't know" & data$age_cat == "50 years or younger") / sum(data$age_cat == "50 years or younger"), 1)`%).  In contrast, older participants most frequently recommended visiting churches (`r round(100 * sum(data$reach_more_ppl == "Visit churches" & data$age_cat == "Over 50 years") / sum(data$age_cat == "Over 50 years"), 1)`%).  

These findings suggest that oureach preferences differ by age group. Younger participants favored broad adverising and school-based approches, reflecting their likely engagement with medica and edicational settings. Older participants emphasized churches as trusted community spaces, highlighting the role of faith-based organizations in program dissemination. 







.




